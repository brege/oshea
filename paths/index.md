# Path Registry Index

This directory contains the project's centralized pathing registry. 

This system eliminates brittle, relative `require()` paths in favor of a single, aliased source of truth (`@paths`), making the codebase more robust and easier to refactor.

The registry is automatically generated by the script at [`generator.js`](./generator.js), based on the declarative configuration in [`paths-config.yaml`](./paths-config.yaml).

### Core Registry Files

- `paths-config.yaml` 
  -- The declarative configuration file for the path registry.
- `generator.js`
  -- The script that generates the registry files.

### Generated Registry Files

This file is **automatically generated**. Do not edit them directly.

[ [**`index.js`**](./index.js) ] 

To update it:
1. Edit [`paths-config.yaml`](./paths-config.yaml)
2. Run the
   ```bash
   node paths/generator.js [ --force ]
   ``` 

### How do I link to something?

**Good**
```js
require('module-alias/register');
const { lintPath } = require('@paths');                     // ✔ good
const { main } = require(lintPath);
```

**Bad**
```js
//  Don't do this
const { findFiles } = require('../../shared/file-helpers'); // ✖ double dots
const { findFiles } = require(paths['fileHelpersPath']);    // ✖ dynamic key
const __dirname = ...;                                      // ✖ redeclaration
``` 

For any given file, you can generate the above code with the following command:
```bash
node paths/path-finder.js src/completion/engine.js
```

[This tool](path-finder.js) helps build the import statements in the above example.

Use on multiple files or directories as needed.

```bash
node paths/path-finder.js src/completion/
```
```js
node paths/path-finder.js src/completion/
require('module-alias/register');
const {
  cliTreeBuilderPath,
  enginePath,
  generateCompletionCachePath,
  generateCompletionDynamicCachePath,
  trackerPath
} = require('@paths');
// File: src/completion/cli-tree-builder.js
// File: src/completion/engine.js
// File: src/completion/generate-completion-cache.js
// File: src/completion/generate-completion-dynamic-cache.js
// File: src/completion/tracker.js
```

As a companion to [`path-finder.js`](path-finder.js),
the following files can be used to generate the dependency tree from the pathing registry:

- [ [`dep-tree.js`](dep-tree.js) ]
  -- The main dependency tree runner.

  **Command.**
  ```bash
  node paths/dep-tree.js src/cli/commands/collection.command.js --tree
  ```
  **Output.**
  ```txt

  Tracing dependencies for: src/cli/commands/collection.command.js
  ============================================================

  Dependency Tree:
  ----------------------------------------
  └── src/cli/commands/collection.command.js (collectionCommandPath)
      ├── paths/index.js (pathsPath)
      │   ├── paths/scripts.js 
      │   └── paths/tests.js 
      ├── src/cli/commands/collection/add.command.js (collectionsAddCommandPath)
      │   ├── paths/index.js  (collapsed)
      │   └── src/utils/logger.js (loggerPath)
      │       ├── paths/index.js  (collapsed)
      │       └── src/utils/formatters/index.js (formattersIndexPath)
      │           ├── paths/index.js  (collapsed)
      │           ├── src/utils/formatters/app.formatter.js (appFormatterPath)
      │           ├── src/utils/formatters/inline.formatter.js (inlineFormatterPath)
      │           ├── src/utils/formatters/raw.formatter.js (rawFormatterPath)
      │           └── src/utils/formatters/paths.formatter.js (pathsFormatterPath)
      ├── src/cli/commands/collection/list.command.js (collectionsListCommandPath)
      │   ├── paths/index.js  (collapsed)
      │   └── src/utils/logger.js  (collapsed)
      ├── src/cli/commands/collection/remove.command.js (collectionsRemoveCommandPath)
      │   ├── paths/index.js  (collapsed)
      │   └── src/utils/logger.js  (collapsed)
      └── src/cli/commands/collection/update.command.js (collectionsUpdateCommandPath)
          ├── paths/index.js  (collapsed)
          └── src/utils/logger.js  (collapsed)
  ```
  **Usage.**
  ```bash
  node paths/dep-tree.js <file ...> [--export <dir>] [--include <path ...> | -P <path ...>] [options]
  ```
  These files construct the dependency graph and render it as a tree diagram, respectively.
    - [ [`dependency-tracer.js`](lib/dependency-tracer.js) ]
    - [ [`tree-renderer.js`](lib/tree-renderer.js) ]
